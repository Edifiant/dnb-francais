<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Objectif Brevet</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>

<style>
:root{
 --bg:#f8fafc; --card:#fff; --txt:#1e293b;
 --blue:#2563eb; --violet:#7c3aed; --green:#10b981;
}
.dark{ --bg:#0f172a; --card:#1e293b; --txt:#e2e8f0; }

body{font-family:Inter,Segoe UI,sans-serif;background:var(--bg);color:var(--txt);margin:0;padding:20px}
.container{max-width:900px;margin:auto}

.hero{text-align:center;margin-bottom:25px}
.progress-bar{height:10px;background:#e2e8f0;border-radius:20px;margin-top:10px}
#progress{height:100%;width:0;background:var(--green);border-radius:20px;transition:1s}

.nav-menu{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin-bottom:20px}
.nav-btn{padding:10px 18px;border-radius:30px;border:none;background:white;cursor:pointer;font-weight:700}
.nav-btn:hover{transform:translateY(-2px)}
.special{background:var(--violet);color:white}

.fiche-bristol,.card-quiz{
 background:var(--card);padding:25px;border-radius:16px;margin-bottom:25px;
 box-shadow:0 8px 20px rgba(0,0,0,0.08);animation:fade 0.6s ease
}
@keyframes fade{from{opacity:0;transform:translateY(10px)}}

.opt-btn{display:block;width:100%;padding:14px;margin:8px 0;border-radius:10px;border:2px solid #eee;cursor:pointer}
.correct{background:#dcfce7}
.wrong{background:#fee2e2}

.badge{background:var(--blue);color:white;padding:4px 12px;border-radius:20px;font-size:12px}

.toggle{position:fixed;top:10px;right:10px;font-size:20px;cursor:pointer}
</style>
</head>

<body>

<div class="toggle" onclick="toggleDark()">ðŸŒ™</div>

<div class="container">
<div class="hero">
<h1>Objectif Brevet</h1>
<div id="score">0 quiz rÃ©ussis</div>
<div class="progress-bar"><div id="progress"></div></div>
</div>

<div class="nav-menu" id="menu"></div>
<div id="app">Chargement...</div>
</div>

<script>
const sections=[
{name:"ðŸ“š Grammaire",gid:"1679242234"},
{name:"ðŸ•°ï¸ Conjugaison",gid:"1987121612"},
{name:"âœ¨ Figures",gid:"1943336125"},
{name:"ðŸ§  Fiches",gid:"1143879514"},
{name:"ðŸª¶ Vocabulaire",gid:"710791745"},
{name:"âœï¸ DictÃ©es",gid:"586561849"},
{name:"ðŸ‘¤ Auteurs",gid:"951178030"}
];

const url="https://docs.google.com/spreadsheets/d/e/2PACX-1vRoAJJNx2wqbdV3bqbJDt0cmf8DPCCk39wiQa4fdpkHj8fFcKBf0T4viApM-A3lSWbXHeJ8uasSh-M0/pub?single=true&output=csv&gid=";
const menu=document.getElementById("menu");
const app=document.getElementById("app");

let score=localStorage.getItem("score")||0;
updateScore();

sections.forEach((s,i)=>{
 let b=document.createElement("button");
 b.className="nav-btn";
 b.innerText=s.name;
 b.onclick=()=>loadData(s.gid);
 menu.appendChild(b);
});

let surprise=document.createElement("button");
surprise.className="nav-btn special";
surprise.innerText="ðŸŽ² Surprise";
surprise.onclick=randomSection;
menu.appendChild(surprise);

function randomSection(){
 let r=sections[Math.floor(Math.random()*sections.length)];
 loadData(r.gid);
}

function toggleDark(){document.body.classList.toggle("dark")}

function updateScore(){
 document.getElementById("score").innerText=score+" quiz rÃ©ussis";
 document.getElementById("progress").style.width=(score%20)*5+"%";
}

function loadData(gid){
 app.innerHTML="Chargement...";
 Papa.parse(url+gid,{
 download:true,header:true,skipEmptyLines:true,
 complete:(res)=>render(res.data)
 });
}

function render(data){
 let html="";
 data.forEach((row,i)=>{
  if(row.Question){
   const good=row.Bonne_RÃ©ponse.trim().toUpperCase();
   html+=`
   <div class="card-quiz">
   <span class="badge">EntraÃ®nement</span>
   <h3>${row.Question}</h3>
   ${["A","B","C","D"].map(l=>{
     if(!row["RÃ©ponse_"+l])return "";
     return `<button class="opt-btn" onclick="check('${l}','${good}',${i})">${l}. ${row["RÃ©ponse_"+l]}</button>`;
   }).join("")}
   <div id="fb-${i}"></div>
   </div>`;
  }else{
   html+=`<div class="fiche-bristol"><h2>${row.Titre||""}</h2>${row.Contenu||row.DÃ©finition||""}</div>`;
  }
 });
 app.innerHTML=html;
}

function check(click,correct,id){
 let fb=document.getElementById("fb-"+id);
 if(click===correct){
   score++; localStorage.setItem("score",score); updateScore();
   fb.innerHTML="ðŸ”¥ Bravo !";
   fb.className="correct";
 }else{
   fb.innerHTML="Encore !";
   fb.className="wrong";
 }
}

loadData(sections[0].gid);
</script>
</body>
</html>
